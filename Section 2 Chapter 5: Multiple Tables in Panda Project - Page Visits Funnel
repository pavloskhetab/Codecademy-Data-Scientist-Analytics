Page Visits Funnel
Cool T-Shirts Inc. has asked you to analyze data on visits to their website. 
Your job is to build a funnel, which is a description of how many people 
continue to the next step of a multi-step process.

In this case, our funnel is going to describe the following process:

A user visits CoolTShirts.com
A user adds a t-shirt to their cart
A user clicks “checkout”
A user actually purchases a t-shirt


Funnel for Cool T-Shirts Inc.
1. Inspect the DataFrames using print and head:

visits lists all of the users who have visited the website
cart lists all of the users who have added a t-shirt to their cart
checkout lists all of the users who have started the checkout
purchase lists all of the users who have purchased a t-shirt


2. Combine visits and cart using a left merge.


3. How long is your merged DataFrame?


4. How many of the timestamps are null for the column cart_time?

What do these null rows mean?


5. What percent of users who visited Cool T-Shirts Inc. ended up not placing a t-shirt in their cart?

Note: To calculate percentages, it will be helpful to turn either the numerator or the denominator into a float, by using float(), with the number to convert passed in as input. Otherwise, Python will use integer division, which truncates decimal points.


6. Repeat the left merge for cart and checkout and count null values. What percentage of users put items in their cart, but did not proceed to checkout?


7. Merge all four steps of the funnel, in order, using a series of left merges. Save the results to the variable all_data.

Examine the result using print and head.

8. What percentage of users proceeded to checkout, but did not purchase a t-shirt?


9. Which step of the funnel is weakest (i.e., has the highest percentage of users not completing it)?

How might Cool T-Shirts Inc. change their website to fix this problem?


Average Time to Purchase
10. Using the giant merged DataFrame all_data that you created, let’s calculate the average time from initial visit to final purchase. Add a column that is the difference between purchase_time and visit_time.


11. Examine the results by printing the new column to the screen.


12. Calculate the average time to purchase by applying the .mean() function to your new column.


Code:
import codecademylib3
import pandas as pd

visits = pd.read_csv('visits.csv',
                     parse_dates=[1])
cart = pd.read_csv('cart.csv',
                   parse_dates=[1])
checkout = pd.read_csv('checkout.csv',
                       parse_dates=[1])
purchase = pd.read_csv('purchase.csv',
                       parse_dates=[1])


# Part 1: Inspect the DataFrames
print(visits.head())
print(cart.head())
print(checkout.head())
print(purchase.head())


# Part 2: Left merge visits and cart
visits_cart_left_merge = pd.merge(visits, cart, how = 'left')


# Part 3: Find the length of the merged DataFrame
print(len(visits_cart_left_merge))


# Part 4: Count the null values in cart_time
null_count_cart_time = visits_cart_left_merge['cart_time'].isnull().sum()

# Hint's format
# null_count_cart_time = visits_cart_left_merge[visits_cart_left_merge['cart_time'].isnull()]

print(null_count_cart_time)
